function PhotoFit(){this.photoListGroup=$(".photos-list-group")}PhotoFit.prototype.listenLoadAllDataEvent=function(){var l=this;antajax.get({url:"/photo/list/",success:function(t){if(200===t.code)for(var o=t.data,e=0;e<o.length;e++){var n=o[e],a=template("photos-item",{photo:n});l.photoListGroup.append(a);var i=l.photoListGroup.find(".photos-item:last"),s=l.photoListGroup.find(".data-item:last");l.listenAddImageEvent(i),l.listenCloseBtnEvent(i),l.listenSavePhotoBtnEvent(i),l.listenExtractDataEvent(i),l.listenDisplayPersonModelEvent(i),l.listenLoadAllModelEvent(s)}}})},PhotoFit.prototype.listenAddBannerUpEvent=function(){var t=this;$("#add-photo-btn").click(function(){6<=t.photoListGroup.children().length?window.messageBox.showInfo("只能添加6张图片哦~~"):t.createPhotoBtnEvent()})},PhotoFit.prototype.createPhotoBtnEvent=function(){var t=this,o=template("photos-item");t.photoListGroup.prepend(o);var e=t.photoListGroup.find(".photos-item:first"),n=t.photoListGroup.find(".data-item:last");t.listenAddImageEvent(e),t.listenCloseBtnEvent(e),t.listenSavePhotoBtnEvent(e),t.listenExtractDataEvent(e),t.listenDisplayPersonModelEvent(e),t.listenLoadAllModelEvent(n)},PhotoFit.prototype.listenAddImageEvent=function(t){var e=t.find(".thumbnail"),o=t.find(".image-input");e.click(function(){o.click()}),o.change(function(){var t=this.files[0],o=new FormData;o.append("file",t),antajax.post({url:"/upload/file/",data:o,processData:!1,contentType:!1,success:function(t){if(200===t.code){var o=t.data.url;e.attr("src",o)}}})})},PhotoFit.prototype.listenCloseBtnEvent=function(e){var n=this;e.find(".close-btn").click(function(){var t=e.attr("data-photo-id"),o=n.photoListGroup.find(".data-item");t?antalert.alertConfirm({text:"您确定要删除该照片吗？无法撤销哦！~~~",confirmCallback:function(){antajax.post({url:"/del/photo/",data:{photo_id:t},success:function(t){e.remove(),o.remove(),window.messageBox.showSuccess(t.message)}})}}):(e.remove(),o.remove())})},PhotoFit.prototype.listenSavePhotoBtnEvent=function(t){var o=t.find(".save-btn"),e=t.find(".thumbnail");o.click(function(){var t=e.attr("src");antajax.post({url:"/save/photo/",data:{img_url:t},success:function(t){200===t.code?window.messageBox.showSuccess("图片保存成功！"):(console.log(t.code),console.log(t.message))},fail:function(t){console.log(t.message)}})})},PhotoFit.prototype.listenAddBannerEvent=function(){var t=this;$("#add-photo-btn").click(function(){t.createPhotoBtnEvent()})},PhotoFit.prototype.listenExtractDataEvent=function(o){o.find(".extract-data-btn").click(function(){var t=o.find(".thumbnail").attr("src");antajax.post({url:"/extract/data/",data:{img_url:t},success:function(t){200===t.code&&window.messageBox.showSuccess(t.message)}})})},PhotoFit.prototype.listenDisplayPersonModelEvent=function(t){var a=this,i=(t.find(".data-item"),t.find(".modelThumbnail"));t.find(".extract-data-btn").click(function(){antajax.get({url:"/model/serialize/",success:function(t){if(200===t.code){models=t.data;for(var o=0;o<models.length;o++){var e=models[o],n=template("photos-item",{model:e});a.photoListGroup.append(n),url=t.data[o].model_url,console.log(url),i.attr("src",url)}}}})})},PhotoFit.prototype.listenLoadAllModelEvent=function(t){var a=t.find(".modelThumbnail");antajax.get({url:"/model/serialize/",success:function(t){if(200===t.code)for(var o=t.data,e=0;e<o.length;e++){var n=t.data[e].model_url;a.attr("src",n)}}})},PhotoFit.prototype.run=function(){this.listenExtractDataEvent()},PhotoFit.prototype.run=function(){this.listenAddBannerEvent(),this.listenLoadAllDataEvent()},$(function(){(new PhotoFit).run()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBob3RvRml0LmpzIl0sIm5hbWVzIjpbIlBob3RvRml0IiwidGhpcyIsInBob3RvTGlzdEdyb3VwIiwiJCIsInByb3RvdHlwZSIsImxpc3RlbkxvYWRBbGxEYXRhRXZlbnQiLCJzZWxmIiwiYW50YWpheCIsImdldCIsInVybCIsInN1Y2Nlc3MiLCJyZXN1bHQiLCJwaG90b3MiLCJpIiwibGVuZ3RoIiwicGhvdG8iLCJ0cGwiLCJ0ZW1wbGF0ZSIsImFwcGVuZCIsInBob3RvSXRlbSIsImZpbmQiLCJkYXRhSXRlbSIsImxpc3RlbkFkZEltYWdlRXZlbnQiLCJsaXN0ZW5DbG9zZUJ0bkV2ZW50IiwibGlzdGVuU2F2ZVBob3RvQnRuRXZlbnQiLCJsaXN0ZW5FeHRyYWN0RGF0YUV2ZW50IiwibGlzdGVuRGlzcGxheVBlcnNvbk1vZGVsRXZlbnQiLCJsaXN0ZW5Mb2FkQWxsTW9kZWxFdmVudCIsImxpc3RlbkFkZEJhbm5lclVwRXZlbnQiLCJjbGljayIsImNoaWxkcmVuIiwid2luZG93IiwibWVzc2FnZUJveCIsInNob3dJbmZvIiwiY3JlYXRlUGhvdG9CdG5FdmVudCIsInByZXBlbmQiLCJ0aHVtYm5haWwiLCJpbWFnZUlucHV0IiwiY2hhbmdlIiwiZmlsZSIsImZpbGVzIiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsInBvc3QiLCJkYXRhIiwicHJvY2Vzc0RhdGEiLCJjb250ZW50VHlwZSIsImF0dHIiLCJwaG90b0lkIiwibW9kZWxJdGVtIiwiYW50YWxlcnQiLCJhbGVydENvbmZpcm0iLCJ0ZXh0IiwiY29uZmlybUNhbGxiYWNrIiwicGhvdG9faWQiLCJyZW1vdmUiLCJzaG93U3VjY2VzcyIsInNhdmVCdG4iLCJ0aHVtYm5haWxUYWciLCJpbWdfdXJsIiwiY29uc29sZSIsImxvZyIsImZhaWwiLCJlcnJvciIsImxpc3RlbkFkZEJhbm5lckV2ZW50IiwibW9kZWxUaHVtYm5haWwiLCJtb2RlbHMiLCJtb2RlbCIsInJ1biJdLCJtYXBwaW5ncyI6IkFBQ0EsU0FBU0Es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UCxJQUFNRSxFQUFhLEtBQUVFLEdBQWMsVUFDbkMrQyxRQUFRQyxJQUFJcEQsS0FDWndELEVBQWVsQixLQUFLLE1BQU90QyxhQWFuRFQsU0FBU0ksVUFBVXVCLHdCQUEwQixTQUFVTixHQUNuRCxJQUVJZSxFQUFZZixFQUFTRCxLQUFLLG1CQUU5QmIsUUFBUUMsSUFBSSxDQUNSQyxJQUFPLG9CQUNQQyxRQUFXLFNBQVVDLEdBQ2pCLEdBQXVCLE1BQW5CQSxFQUFhLEtBRWIsSUFEQSxJQUFJdUQsRUFBU3ZELEVBQWEsS0FDakJFLEVBQUksRUFBR0EsRUFBSXFELEVBQU9wRCxPQUFRRCxJQUFLLENBQ3BDLElBQUlKLEVBQU1FLEVBQWEsS0FBRUUsR0FBYyxVQUN2Q3VCLEVBQVVXLEtBQUssTUFBT3RDLFFBTzFDVCxTQUFTSSxVQUFVZ0UsSUFBTSxXQUNyQm5FLEtBQUt3QiwwQkFHVHpCLFNBQVNJLFVBQVVnRSxJQUFNLFdBQ3JCbkUsS0FBSytELHVCQUNML0QsS0FBS0ksMEJBR1RGLEVBQUUsWUFDYyxJQUFJSCxVQUNWb0UiLCJmaWxlIjoicGhvdG9GaXQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8g5re75Yqg54Wn54mHXHJcbmZ1bmN0aW9uIFBob3RvRml0KCkge1xyXG4gICAgdGhpcy5waG90b0xpc3RHcm91cCA9ICQoXCIucGhvdG9zLWxpc3QtZ3JvdXBcIik7XHJcbn1cclxuXHJcbi8vIOWKoOi9veaJgOaciXBob3Rv5LqL5Lu2XHJcblBob3RvRml0LnByb3RvdHlwZS5saXN0ZW5Mb2FkQWxsRGF0YUV2ZW50ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgYW50YWpheC5nZXQoe1xyXG4gICAgICAgICd1cmwnOiAnL3Bob3RvL2xpc3QvJyxcclxuICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgIHZhciBwaG90b3MgPSByZXN1bHRbJ2RhdGEnXTtcclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGhvdG9zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBob3RvID0gcGhvdG9zW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB0cGwgPSB0ZW1wbGF0ZSgncGhvdG9zLWl0ZW0nLCB7J3Bob3RvJzogcGhvdG99KTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLnBob3RvTGlzdEdyb3VwLmFwcGVuZCh0cGwpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyDkuLrmlrDmt7vliqDnmoRwaG90b+a3u+WKoOWFs+mXreOAgeS/neWtmOS6i+S7tlxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBwaG90b0l0ZW0gPSBzZWxmLnBob3RvTGlzdEdyb3VwLmZpbmQoXCIucGhvdG9zLWl0ZW06bGFzdFwiKTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgZGF0YUl0ZW0gPSBzZWxmLnBob3RvTGlzdEdyb3VwLmZpbmQoXCIuZGF0YS1pdGVtOmxhc3RcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0ZW5BZGRJbWFnZUV2ZW50KHBob3RvSXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0ZW5DbG9zZUJ0bkV2ZW50KHBob3RvSXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0ZW5TYXZlUGhvdG9CdG5FdmVudChwaG90b0l0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGVuRXh0cmFjdERhdGFFdmVudChwaG90b0l0ZW0pO1xyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGVuRGlzcGxheVBlcnNvbk1vZGVsRXZlbnQocGhvdG9JdGVtKTtcclxuICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RlbkxvYWRBbGxNb2RlbEV2ZW50KGRhdGFJdGVtKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy8g6ZmQ5Yi25Y+q6IO95LiK5LygNuW8oOi9ruaSreWbvuS6i+S7tlxyXG5QaG90b0ZpdC5wcm90b3R5cGUubGlzdGVuQWRkQmFubmVyVXBFdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBhZGRCdG4gPSAkKFwiI2FkZC1waG90by1idG5cIik7XHJcbiAgICBhZGRCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHZhciBwaG90b0xlbmd0aCA9IHNlbGYucGhvdG9MaXN0R3JvdXAuY2hpbGRyZW4oKS5sZW5ndGg7XHJcbiAgICAgICAgaWYgKHBob3RvTGVuZ3RoID49IDYpIHtcclxuICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd0luZm8oXCLlj6rog73mt7vliqA25byg5Zu+54mH5ZOmfn5cIik7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgc2VsZi5jcmVhdGVQaG90b0J0bkV2ZW50KCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcbi8vIOWIm+W7uuWNoeeJh+eahOaMiemSruS6i+S7tlxyXG5QaG90b0ZpdC5wcm90b3R5cGUuY3JlYXRlUGhvdG9CdG5FdmVudCA9IGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIC8vIHRlbXBsYXRlKCnlh73mlbDov5Tlm57nmoTmmK/lrZfnrKbkuLLvvIzkuI3og73lpJ/lhbbmt7vliqDngrnlh7vkuovku7bvvIxcclxuICAgIC8vIOmcgOimgeWwhuWFtua3u+WKoOWkp+e9kemhteS4re+8jOaIkOS4uue9kemhteS4reeahOagh+etvlxyXG4gICAgdmFyIHRwbCA9IHRlbXBsYXRlKFwicGhvdG9zLWl0ZW1cIik7XHJcbiAgICBzZWxmLnBob3RvTGlzdEdyb3VwLnByZXBlbmQodHBsKTtcclxuXHJcbiAgICAvLyDmt7vliqDngrnlh7vkuovku7blv4XpobvlnKjmt7vliqB0cGzliLDnvZHpobXkuK3kuYvlkI5cclxuICAgIHZhciBwaG90b0l0ZW0gPSBzZWxmLnBob3RvTGlzdEdyb3VwLmZpbmQoXCIucGhvdG9zLWl0ZW06Zmlyc3RcIik7XHJcbiAgICB2YXIgZGF0YUl0ZW0gPSBzZWxmLnBob3RvTGlzdEdyb3VwLmZpbmQoXCIuZGF0YS1pdGVtOmxhc3RcIik7XHJcblxyXG4gICAgc2VsZi5saXN0ZW5BZGRJbWFnZUV2ZW50KHBob3RvSXRlbSk7XHJcbiAgICBzZWxmLmxpc3RlbkNsb3NlQnRuRXZlbnQocGhvdG9JdGVtKTtcclxuICAgIHNlbGYubGlzdGVuU2F2ZVBob3RvQnRuRXZlbnQocGhvdG9JdGVtKTtcclxuICAgIHNlbGYubGlzdGVuRXh0cmFjdERhdGFFdmVudChwaG90b0l0ZW0pO1xyXG4gICAgc2VsZi5saXN0ZW5EaXNwbGF5UGVyc29uTW9kZWxFdmVudChwaG90b0l0ZW0pO1xyXG4gICAgc2VsZi5saXN0ZW5Mb2FkQWxsTW9kZWxFdmVudChkYXRhSXRlbSk7XHJcbn07XHJcblxyXG4vLyDmt7vliqDngrnlh7vmt7vliqDlm77niYfkuovku7Ys5bCG5Zu+54mH5L+d5a2Y6Iez5pys5Zyw5pyN5Yqh5ZmoXHJcblBob3RvRml0LnByb3RvdHlwZS5saXN0ZW5BZGRJbWFnZUV2ZW50ID0gZnVuY3Rpb24gKHBob3RvSXRlbSkge1xyXG4gICAgdmFyIHRodW1ibmFpbCA9IHBob3RvSXRlbS5maW5kKFwiLnRodW1ibmFpbFwiKTtcclxuICAgIHZhciBpbWFnZUlucHV0ID0gcGhvdG9JdGVtLmZpbmQoXCIuaW1hZ2UtaW5wdXRcIik7XHJcbiAgICAvLyDkuZ/lj6/ku6XpgJrov4fku6XkuIvmlrnlvI/nhaflvZPlvZPliY10aHVtYm5haWzlkIznuqfnmoRpbWFnZS1pbnB1dFxyXG4gICAgLy8gdmFyIGltYWdlSW5wdXQgPSB0aHVtYm5haWwuc2libGluZ3MoXCIuaW1hZ2UtaW5wdXRcIik7XHJcblxyXG4gICAgLy8g5Li65b2T5YmN55qE5Zu+54mH5re75Yqg54K55Ye75LqL5Lu2XHJcbiAgICB0aHVtYm5haWwuY2xpY2soZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIGltYWdlSW5wdXQuY2xpY2soKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIOS4uuW9k+WJjemAieS4reeahOWbvueJh+a3u+WKoOaJk+W8gOS6i+S7tu+8jOWNs2NoYW5nZSgp5LqL5Lu2XHJcbiAgICBpbWFnZUlucHV0LmNoYW5nZShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8g6I635Y+W5b2T5YmN6YCJ5Lit55qE5paH5Lu2XHJcbiAgICAgICAgLy8gdGhpcy7ku6PooajlvZPliY3nmoRpbWFnZS1pbnB1dFxyXG4gICAgICAgIHZhciBmaWxlID0gdGhpcy5maWxlc1swXTtcclxuICAgICAgICAvLyDpgJrov4dGb3JtRGF0YSgp5Ye95pWw5Yib5bu65LiA5Liq56m655qE5a+56LGh77yM5LmL5ZCO5bCx5Y+v5Lul6YCa6L+HYXBwZW5kKCksc2V0KCksZ2V0KCnnrYnlr7nor6Xlr7nosaHov5vooYzmt7vliqDvvIzorr7nva7vvIzojrflj5bmk43kvZxcclxuICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcclxuICAgICAgICAvLyDkuIrkvKDliLDmnKzlnLDmnI3liqHlmajnmoTmjqXlj6PmmK/pgJrov4cnZmlsZSdcclxuICAgICAgICBmb3JtRGF0YS5hcHBlbmQoXCJmaWxlXCIsIGZpbGUpO1xyXG4gICAgICAgIGFudGFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiBcIi91cGxvYWQvZmlsZS9cIixcclxuICAgICAgICAgICAgJ2RhdGEnOiBmb3JtRGF0YSxcclxuICAgICAgICAgICAgJ3Byb2Nlc3NEYXRhJzogZmFsc2UsXHJcbiAgICAgICAgICAgICdjb250ZW50VHlwZSc6IGZhbHNlLFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybCA9IHJlc3VsdFsnZGF0YSddWyd1cmwnXTtcclxuICAgICAgICAgICAgICAgICAgICB0aHVtYm5haWwuYXR0cignc3JjJywgdXJsKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn07XHJcblxyXG5cclxuLy8g55uR5ZCs5Yig6Zmk5Y2h54mH55qE5YWz6Zet5oyJ6ZKuXHJcblBob3RvRml0LnByb3RvdHlwZS5saXN0ZW5DbG9zZUJ0bkV2ZW50ID0gZnVuY3Rpb24gKHBob3RvSXRlbSkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgLy8gdmFyIGNsb3NlQnRuID0gJChcIi5jbG9zZS1idG5cIik7XHJcbiAgICB2YXIgY2xvc2VCdG4gPSBwaG90b0l0ZW0uZmluZChcIi5jbG9zZS1idG5cIik7XHJcbiAgICAvLyB2YXIgY2xvc2VNb2RlbEJ0biA9IHBob3RvSXRlbS5maW5kKFwiLmNsb3NlLW1vZGVsLWJ0blwiKTtcclxuXHJcbiAgICBjbG9zZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gdmFyIHBob3RvSXRlbSA9ICQoXCIucGhvdG9zLWl0ZW1cIik7XHJcbiAgICAgICAgLy8gcGhvdG9JdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgIHZhciBwaG90b0lkID0gcGhvdG9JdGVtLmF0dHIoXCJkYXRhLXBob3RvLWlkXCIpO1xyXG5cclxuICAgICAgICB2YXIgbW9kZWxJdGVtID0gc2VsZi5waG90b0xpc3RHcm91cC5maW5kKFwiLmRhdGEtaXRlbVwiKTtcclxuXHJcbiAgICAgICAgaWYgKHBob3RvSWQpIHtcclxuICAgICAgICAgICAgYW50YWxlcnQuYWxlcnRDb25maXJtKHtcclxuICAgICAgICAgICAgICAgICd0ZXh0JzogJ+aCqOehruWumuimgeWIoOmZpOivpeeFp+eJh+WQl++8n+aXoOazleaSpOmUgOWTpu+8gX5+ficsXHJcbiAgICAgICAgICAgICAgICAnY29uZmlybUNhbGxiYWNrJzogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGFudGFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICd1cmwnOiAnL2RlbC9waG90by8nLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZGF0YSc6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdwaG90b19pZCc6IHBob3RvSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvdG9JdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxJdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MocmVzdWx0WydtZXNzYWdlJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHBob3RvSXRlbS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgbW9kZWxJdGVtLnJlbW92ZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59O1xyXG5cclxuLy8g55uR5ZCs5L+d5a2Y5Y2h54mH55qE5LqL5Lu2XHJcblBob3RvRml0LnByb3RvdHlwZS5saXN0ZW5TYXZlUGhvdG9CdG5FdmVudCA9IGZ1bmN0aW9uIChwaG90b0l0ZW0pIHtcclxuICAgIHZhciBzYXZlQnRuID0gcGhvdG9JdGVtLmZpbmQoXCIuc2F2ZS1idG5cIik7XHJcbiAgICB2YXIgdGh1bWJuYWlsVGFnID0gcGhvdG9JdGVtLmZpbmQoXCIudGh1bWJuYWlsXCIpO1xyXG4gICAgc2F2ZUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8g6I635Y+WaW1n5Zu+54mH55qEc3Jj5bGe5oCn5a+55bqU55qE5YC877yM5Y+q6ZyA6KaB6LCD55SoYXR0cigp5Ye95pWw5bCx5Y+v5Lul5LqG77yM5bm25LiN6ZyA6KaB6LCD55SodmFsKClcclxuICAgICAgICB2YXIgaW1nX3VybCA9IHRodW1ibmFpbFRhZy5hdHRyKFwic3JjXCIpO1xyXG4gICAgICAgIGFudGFqYXgucG9zdCh7XHJcbiAgICAgICAgICAgICd1cmwnOiAnL3NhdmUvcGhvdG8vJyxcclxuICAgICAgICAgICAgJ2RhdGEnOiB7XHJcbiAgICAgICAgICAgICAgICAnaW1nX3VybCc6IGltZ191cmwsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdFsnY29kZSddID09PSAyMDApIHtcclxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubWVzc2FnZUJveC5zaG93U3VjY2VzcyhcIuWbvueJh+S/neWtmOaIkOWKn++8gVwiKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0Wydjb2RlJ10pO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdFsnbWVzc2FnZSddKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2ZhaWwnOiBmdW5jdGlvbiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yWydtZXNzYWdlJ10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG5QaG90b0ZpdC5wcm90b3R5cGUubGlzdGVuQWRkQmFubmVyRXZlbnQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgYWRkUGhvdG9CdG4gPSAkKFwiI2FkZC1waG90by1idG5cIik7XHJcbiAgICBhZGRQaG90b0J0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgc2VsZi5jcmVhdGVQaG90b0J0bkV2ZW50KCk7XHJcbiAgICB9KTtcclxufTtcclxuXHJcblxyXG4vLyDmqKHlnovmnInlhbNcclxuLy8g55uR5ZCs5o+Q5Lqk5b2T5YmN54Wn54mH5LqL5Lu2XHJcblBob3RvRml0LnByb3RvdHlwZS5saXN0ZW5FeHRyYWN0RGF0YUV2ZW50ID0gZnVuY3Rpb24gKHBob3RvSXRlbSkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGV4dHJhY3REYXRhQnRuID0gcGhvdG9JdGVtLmZpbmQoXCIuZXh0cmFjdC1kYXRhLWJ0blwiKTtcclxuXHJcbiAgICBleHRyYWN0RGF0YUJ0bi5jbGljayhmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgLy8gdmFyIHRwbCA9IHRlbXBsYXRlKFwiZGF0YS1pdGVtXCIpO1xyXG4gICAgICAgIC8vIHNlbGYuZGF0YUxpc3RHcm91cC5wcmVwZW5kKHRwbCk7XHJcbiAgICAgICAgdmFyIHRodW1ibmFpbFRhZyA9IHBob3RvSXRlbS5maW5kKFwiLnRodW1ibmFpbFwiKTtcclxuXHJcbiAgICAgICAgLy8g6I635Y+WaW1n5Zu+54mH55qEc3Jj5bGe5oCn5a+55bqU55qE5YC877yM5Y+q6ZyA6KaB6LCD55SoYXR0cigp5Ye95pWw5bCx5Y+v5Lul5LqG77yM5bm25LiN6ZyA6KaB6LCD55SodmFsKClcclxuICAgICAgICB2YXIgaW1nX3VybCA9IHRodW1ibmFpbFRhZy5hdHRyKFwic3JjXCIpO1xyXG5cclxuICAgICAgICAvLyBjb25zb2xlLmxvZyhpbWdfdXJsKTtcclxuXHJcbiAgICAgICAgYW50YWpheC5wb3N0KHtcclxuICAgICAgICAgICAgJ3VybCc6ICcvZXh0cmFjdC9kYXRhLycsXHJcbiAgICAgICAgICAgICdkYXRhJzoge1xyXG4gICAgICAgICAgICAgICAgJ2ltZ191cmwnOiBpbWdfdXJsLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvd1N1Y2Nlc3MocmVzdWx0WydtZXNzYWdlJ10pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbn07XHJcblxyXG4vLyDlsIbnu4/ov4dPcGVuQ1blpITnkIbkv53lrZjoh7PmnKzlnLDmnI3liqHlmajnmoTnhafniYfmmL7npLrlnKjliY3nq69cclxuUGhvdG9GaXQucHJvdG90eXBlLmxpc3RlbkRpc3BsYXlQZXJzb25Nb2RlbEV2ZW50ID0gZnVuY3Rpb24gKHBob3RvSXRlbSkge1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG5cclxuICAgIHZhciBkYXRhSXRlbSA9IHBob3RvSXRlbS5maW5kKFwiLmRhdGEtaXRlbVwiKTtcclxuXHJcbiAgICB2YXIgbW9kZWxUaHVtYm5haWwgPSBwaG90b0l0ZW0uZmluZChcIi5tb2RlbFRodW1ibmFpbFwiKTtcclxuXHJcbiAgICB2YXIgZXh0cmFjdERhdGFCdG4gPSBwaG90b0l0ZW0uZmluZChcIi5leHRyYWN0LWRhdGEtYnRuXCIpO1xyXG5cclxuICAgIGV4dHJhY3REYXRhQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAgICAgYW50YWpheC5nZXQoe1xyXG4gICAgICAgICAgICAndXJsJzogJy9tb2RlbC9zZXJpYWxpemUvJyxcclxuICAgICAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHZhciBtb2RlbHMgPSByZXN1bHRbJ2RhdGEnXTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGVscy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICAvLyB2YXIgbW9kZWwgPSBtb2RlbHNbaV07XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIC8vIHZhciB0cGwgPSB0ZW1wbGF0ZSgncGhvdG9zLWl0ZW0nLCB7J21vZGVsJzogbW9kZWx9KTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gc2VsZi5waG90b0xpc3RHcm91cC5hcHBlbmQodHBsKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgdXJsID0gcmVzdWx0WydkYXRhJ11bJ21vZGVsX3VybCddO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgICBjb25zb2xlLmxvZyhyZXN1bHRbJ2RhdGEnXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKHVybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKHJlc3VsdFsnZGF0YSddWydpZCddKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICAgbW9kZVRodW1ibmFpbFRhZy5hdHRyKCdzcmMnLCB1cmwpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbW9kZWxzID0gcmVzdWx0WydkYXRhJ107XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtb2RlbHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vZGVsID0gbW9kZWxzW2ldO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHBsID0gdGVtcGxhdGUoJ3Bob3Rvcy1pdGVtJywgeydtb2RlbCc6IG1vZGVsfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGhvdG9MaXN0R3JvdXAuYXBwZW5kKHRwbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHVybCA9IHJlc3VsdFsnZGF0YSddW2ldWydtb2RlbF91cmwnXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2codXJsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWxUaHVtYm5haWwuYXR0cignc3JjJywgdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHVybCA9IHJlc3VsdFsnZGF0YSddWzBdWydtb2RlbF91cmwnXTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBtb2RlbFRodW1ibmFpbC5hdHRyKFwic3JjXCIsIHVybCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59O1xyXG5cclxuXHJcbi8vIOWKoOi9veaJgOacieeahOaooeWei1xyXG5QaG90b0ZpdC5wcm90b3R5cGUubGlzdGVuTG9hZEFsbE1vZGVsRXZlbnQgPSBmdW5jdGlvbiAoZGF0YUl0ZW0pIHtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuXHJcbiAgICB2YXIgdGh1bWJuYWlsID0gZGF0YUl0ZW0uZmluZChcIi5tb2RlbFRodW1ibmFpbFwiKTtcclxuXHJcbiAgICBhbnRhamF4LmdldCh7XHJcbiAgICAgICAgJ3VybCc6ICcvbW9kZWwvc2VyaWFsaXplLycsXHJcbiAgICAgICAgJ3N1Y2Nlc3MnOiBmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGlmIChyZXN1bHRbJ2NvZGUnXSA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWxzID0gcmVzdWx0WydkYXRhJ107XHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGVscy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSByZXN1bHRbJ2RhdGEnXVtpXVsnbW9kZWxfdXJsJ107XHJcbiAgICAgICAgICAgICAgICAgICAgdGh1bWJuYWlsLmF0dHIoJ3NyYycsIHVybCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufTtcclxuXHJcblBob3RvRml0LnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxpc3RlbkV4dHJhY3REYXRhRXZlbnQoKTtcclxufTtcclxuXHJcblBob3RvRml0LnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XHJcbiAgICB0aGlzLmxpc3RlbkFkZEJhbm5lckV2ZW50KCk7XHJcbiAgICB0aGlzLmxpc3RlbkxvYWRBbGxEYXRhRXZlbnQoKTtcclxufTtcclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIHBob3RvID0gbmV3IFBob3RvRml0KCk7XHJcbiAgICBwaG90by5ydW4oKTtcclxufSk7Il19
